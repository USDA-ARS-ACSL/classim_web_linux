services:
  db:
    restart: "no"
    ports:
      - "5432:5432"

  adminer:
    restart: "no"
    ports:
      - "8080:8080"

  backend:
    restart: "no"
    entrypoint:
      - python
      - -m
      - debugpy
      - --listen
      - 0.0.0.0:5678
      - -m
      - uvicorn
      - app.main:app
      - --host
      - 0.0.0.0
      - --port
      - "443"  # Change from 8443 to 443
      - --ssl-certfile
      - /usr/local/share/ca-certificates/ARSMDBE3142ACSL.pem
      - --ssl-keyfile
      - /usr/local/share/ca-certificates/ARSMDBE3142ACSL.key
    # Only expose debugger port to host, not the app ports
    ports:
      - "5678:5678"
    # Remove:
    # - "8443:8443"

  frontend:
    restart: "no"
    # Remove external port bindings if you don't need host access
    # ports:
    #   - "443:443"
    #   - "80:80"

networks:
  traefik-public:
    # For local dev, don't expect an external Traefik network
    external: false


